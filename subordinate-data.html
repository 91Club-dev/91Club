<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Subordinate Data</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            background: #f5f6fa;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0;
            padding: 0;
        }
        .header {
            background: #fff;
            padding: 16px 0;
            text-align: center;
            font-size: 20px;
            font-weight: 500;
            position: relative;
            border-bottom: 1px solid #eee;
        }
        .header .back {
            position: absolute;
            left: 16px;
            top: 16px;
            font-size: 22px;
            color: #333;
            text-decoration: none;
        }
        .search-bar {
            display: flex;
            align-items: center;
            background: #fff;
            margin: 10px 12px 8px 12px;
            border-radius: 8px;
            padding: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.03);
        }
        .search-bar input {
            border: none;
            outline: none;
            flex: 1;
            font-size: 13px;
            background: transparent;
            padding: 8px;
        }
        .search-bar button {
            background: #ff6b5a;
            border: none;
            color: #fff;
            border-radius: 30%;
            width: 38px;
            height: 28px;
            font-size: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .filters {
            display: flex;
            gap: 8px;
            margin: 0 12px 10px 12px;
        }
        .filters select {
            flex: 1;
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #eee;
            background: #fff;
            font-size: 12px;
        }
        .stats-box {
            background: #ff6b5a;
            color: #fff;
            border-radius: 12px;
            margin: 0 12px 16px 12px;
            padding: 20px 4px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-row-gap: 16px;
            grid-column-gap: 0;
            font-size: 11.5px;
            min-height: 160px;
        }
        .stats-box .stat {
            text-align: center;
        }
        .stats-box .stat .value {
            font-size: 13px;
            font-weight: bold;
        }
        .stats-box .stat .value.deposit-number {
            color: #fff !important;
        }
        .stats-box .stat .value.deposit-amount {
            color: #fff !important;
        }
        .no-data {
            text-align: center;
            color: #bbb;
            margin-top: 32px;
            font-size: 13px;
        }
        .no-data-img {
            display: none;
        }
        .no-data-icon {
            display: none;
        }
        .date-modal-overlay {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0; top: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.18);
            justify-content: center;
            align-items: flex-end;
        }
        .date-modal-overlay.active {
            display: flex;
        }
        .date-modal {
            width: 100vw;
            max-width: 500px;
            background: #fff;
            border-radius: 18px 18px 0 0;
            padding: 0 0 10px 0;
            position: relative;
            min-height: 370px;
        }
        .date-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 18px 10px 18px;
            font-size: 17px;
            font-weight: 500;
        }
        .date-modal-header .cancel {
            color: #888;
            font-size: 16px;
            cursor: pointer;
            font-weight: 400;
        }
        .date-modal-header .confirm {
            color: #1abc1a;
            font-size: 16px;
            cursor: pointer;
            font-weight: 400;
        }
        .date-modal-header .title {
            color: #111a3a;
            font-size: 18px;
            font-weight: bold;
            flex: 1;
            text-align: center;
            letter-spacing: 0.5px;
        }
        .date-picker-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 0 10px 0;
            margin: 0 10px;
            position: relative;
            height: 260px;
        }
        .picker-col {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-y: scroll;
            height: 220px;
            scrollbar-width: none;
            -ms-overflow-style: none;
            position: relative;
        }
        .picker-col::-webkit-scrollbar {
            display: none;
        }
        .picker-item {
            font-size: 20px;
            color: #b0b0b0;
            padding: 7px 0;
            text-align: center;
            min-height: 32px;
            transition: color 0.15s, font-weight 0.15s;
            font-weight: 400;
            user-select: none;
        }
        .picker-item.selected {
            color: #222;
            font-weight: bold;
            font-size: 22px;
            background: #f7f7f7;
            border-radius: 8px;
        }
        .picker-col:not(:last-child) {
            border-right: 1px solid #f2f2f2;
        }
        .picker-highlight {
            position: absolute;
            left: 0; right: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 32px;
            background: rgba(0,0,0,0.03);
            border-radius: 8px;
            pointer-events: none;
            z-index: 2;
        }
        .loading-spinner {
            display: none;
            margin: 12px auto 0 auto;
            width: 22px;
            height: 22px;
            border: 3px solid #e0e0e0;
            border-top: 3px solid #bdbdbd;
            border-radius: 50%;
            animation: spin 0.7s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
        }
        .tier-option.selected {
            color: #222 !important;
            font-weight: bold !important;
            background: #f7f7f7;
            border-radius: 8px;
        }
        .tier-option {
            cursor: pointer;
            transition: background 0.15s, color 0.15s;
            font-size: 18px;
            padding: 12px 0;
            width: 100%;
            text-align: center;
            color: #b0b0b0;
            user-select: none;
        }
        .tier-picker-col::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="index.html" class="back">&#8592;</a>
        Subordinate data
    </div>
    <div class="search-bar">
        <input type="text" placeholder="Search subordinate UID">
        <button aria-label="Search">
            <svg width="15" height="15" viewBox="0 0 20 20" fill="white" xmlns="http://www.w3.org/2000/svg">
                <circle cx="9" cy="9" r="7" stroke="white" stroke-width="2" fill="none"/>
                <line x1="14" y1="14" x2="19" y2="19" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
        </button>
    </div>
    <div class="filters">
        <div id="tierSelectBtn" style="flex:1;position:relative;">
            <button id="openTierModal" style="width:100%;padding:8px 0;border-radius:6px;border:1px solid #eee;background:#fff;font-size:12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;">
                <span id="selectedTier">All</span>
                <span style="font-size:14px;margin-left:6px;">&#9662;</span>
            </button>
        </div>
        <div id="date-select" style="flex:1;position:relative;">
            <button id="openDateModal" style="width:100%;padding:8px 0;border-radius:6px;border:1px solid #eee;background:#fff;font-size:12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;">
                <span id="selectedDate">2025-04-25</span>
                <span style="font-size:14px;margin-left:6px;">&#9662;</span>
            </button>
        </div>
    </div>
    <div class="stats-box" id="statsBox">
        <div class="stat">
            <div class="value deposit-number" id="depositNumber">0</div>
            <div>Deposit number</div>
        </div>
        <div class="stat">
            <div class="value deposit-amount" id="depositAmount">0</div>
            <div>Deposit amount</div>
        </div>
        <div class="stat">
            <div class="value" id="numBettors">0</div>
            <div>Number of bettors</div>
        </div>
        <div class="stat">
            <div class="value" id="totalBet">0</div>
            <div>Total bet</div>
        </div>
        <div class="stat">
            <div class="value" id="numFirstDeposit">0</div>
            <div>Number of people making first deposit</div>
        </div>
        <div class="stat">
            <div class="value" id="firstDepositAmount">0</div>
            <div>First deposit amount</div>
        </div>
    </div>
    <div class="loading-spinner" id="loadingSpinner"></div>
    <div class="no-data" id="noData">
        Your commission send to your wallet daily.
    </div>

    <!-- Date Picker Modal -->
    <div class="date-modal-overlay" id="dateModalOverlay">
        <div class="date-modal">
            <div class="date-modal-header">
                <span class="cancel" id="cancelDate">Cancel</span>
                <span class="title">Choose a date</span>
                <span class="confirm" id="confirmDate">Confirm</span>
            </div>
            <div class="date-picker-row">
                <div class="picker-col" id="yearCol"></div>
                <div class="picker-col" id="monthCol"></div>
                <div class="picker-col" id="dayCol"></div>
                <div class="picker-highlight"></div>
            </div>
        </div>
    </div>

    <!-- Tier Modal (visual only, now scrollable) -->
    <div class="date-modal-overlay" id="tierModalOverlay">
        <div class="date-modal" style="min-height: 270px; max-width: 350px;">
            <div class="date-modal-header">
                <span class="cancel" id="cancelTier" style="color:#888;cursor:pointer;">Cancel</span>
                <span class="title" style="color:#111a3a;font-size:18px;font-weight:bold;flex:1;text-align:center;">Choose Tier</span>
                <span class="confirm" id="confirmTier" style="color:#1abc1a;cursor:pointer;">Confirm</span>
            </div>
            <div class="tier-picker-row" style="position:relative;height:180px;margin:0 10px;">
                <div class="tier-picker-col" id="tierCol" style="flex:1;display:flex;flex-direction:column;align-items:center;overflow-y:scroll;height:180px;scrollbar-width:none;-ms-overflow-style:none;position:relative;">
                    <!-- Options will be filled by JS -->
                </div>
                <div class="picker-highlight"></div>
            </div>
        </div>
    </div>
    <script>
        // --- Date Picker Logic ---
        const openDateModal = document.getElementById('openDateModal');
        const dateModalOverlay = document.getElementById('dateModalOverlay');
        const cancelDate = document.getElementById('cancelDate');
        const confirmDate = document.getElementById('confirmDate');
        const selectedDateSpan = document.getElementById('selectedDate');
        const yearCol = document.getElementById('yearCol');
        const monthCol = document.getElementById('monthCol');
        const dayCol = document.getElementById('dayCol');

        let pickerState = { year: 2025, month: 4, day: 25 };

        // Data for specific dates (UPDATED)
        const statsData = {
            "2025-04-28": {
                depositNumber: 176,
                depositAmount: 46293,
                numBettors: 202,
                totalBet: 229381,
                numFirstDeposit: 152,
                firstDepositAmount: 32782
            },
            "2025-04-27": {
                depositNumber: 147,
                depositAmount: 38282,
                numBettors: 191,
                totalBet: 186393,
                numFirstDeposit: 125,
                firstDepositAmount: 27292
            },
            "2025-04-26": {
                depositNumber: 136,
                depositAmount: 25829,
                numBettors: 201,
                totalBet: 76292,
                numFirstDeposit: 103,
                firstDepositAmount: 19729
            },
            "2025-04-25": {
                depositNumber: 104,
                depositAmount: 18380,
                numBettors: 161,
                totalBet: 116207,
                numFirstDeposit: 84,
                firstDepositAmount: 129730
            },
            "2025-04-24": {
                depositNumber: 145,
                depositAmount: 25828,
                numBettors: 201,
                totalBet: 128273,
                numFirstDeposit: 91,
                firstDepositAmount: 15729
            },
            "2025-04-23": {
                depositNumber: 98,
                depositAmount: 15629,
                numBettors: 140,
                totalBet: 64282,
                numFirstDeposit: 75,
                firstDepositAmount: 9297
            },
            "2025-04-22": {
                depositNumber: 195,
                depositAmount: 43829,
                numBettors: 254,
                totalBet: 72894,
                numFirstDeposit: 152,
                firstDepositAmount: 36292
            },
            "2025-04-21": {
                depositNumber: 79,
                depositAmount: 13739,
                numBettors: 103,
                totalBet: 38283,
                numFirstDeposit: 65,
                firstDepositAmount: 8273
            },
            "2025-04-20": {
                depositNumber: 128,
                depositAmount: 23273,
                numBettors: 163,
                totalBet: 42683,
                numFirstDeposit: 102,
                firstDepositAmount: 19729
            }
        };

        function pad(n) { return n.toString().padStart(2, '0'); }

        function fillPickerCol(col, arr, selected) {
            col.innerHTML = '';
            arr.forEach(val => {
                const div = document.createElement('div');
                div.className = 'picker-item' + (val == selected ? ' selected' : '');
                div.textContent = val;
                div.dataset.value = val;
                col.appendChild(div);
            });
        }

        function scrollToSelected(col) {
            const sel = col.querySelector('.selected');
            if (sel) {
                col.scrollTop = sel.offsetTop - col.clientHeight/2 + sel.clientHeight/2;
            }
        }

        function updatePickerCols({year=true, month=true, day=true} = {}) {
            // Only refill columns if needed
            if (year) {
                let years = [];
                for(let y=2022; y<=2025; y++) years.push(y);
                fillPickerCol(yearCol, years, pickerState.year);
            }
            if (month) {
                let months = [];
                for(let m=1; m<=12; m++) months.push(pad(m));
                fillPickerCol(monthCol, months, pad(pickerState.month));
            }
            if (day) {
                let daysInMonth = new Date(pickerState.year, pickerState.month, 0).getDate();
                let days = [];
                for(let d=1; d<=daysInMonth; d++) days.push(pad(d));
                fillPickerCol(dayCol, days, pad(pickerState.day));
            }
            setTimeout(() => {
                scrollToSelected(yearCol);
                scrollToSelected(monthCol);
                scrollToSelected(dayCol);
            }, 10);
        }

        function setSelected(col, value) {
            Array.from(col.children).forEach(child => {
                if (child.dataset.value == value) {
                    child.classList.add('selected');
                } else {
                    child.classList.remove('selected');
                }
            });
        }

        function handlePickerClick(col, key, isDayCol = false) {
            col.addEventListener('click', e => {
                if (e.target.classList.contains('picker-item')) {
                    pickerState[key] = parseInt(e.target.dataset.value);
                    setSelected(col, e.target.dataset.value);
                    if (key === 'year' || key === 'month') {
                        // If year or month changes, update days column
                        updatePickerCols({year:false, month:false, day:true});
                    }
                }
            });
            col.addEventListener('scroll', () => {
                clearTimeout(col._scrollTimeout);
                col._scrollTimeout = setTimeout(() => {
                    let items = Array.from(col.children);
                    let closest = items.reduce((a, b) => {
                        return Math.abs(a.offsetTop - col.scrollTop - col.clientHeight/2 + a.clientHeight/2) <
                               Math.abs(b.offsetTop - col.scrollTop - col.clientHeight/2 + b.clientHeight/2) ? a : b;
                    });
                    pickerState[key] = parseInt(closest.dataset.value);
                    setSelected(col, closest.dataset.value);
                    if ((key === 'year' || key === 'month') && isDayCol) {
                        updatePickerCols({year:false, month:false, day:true});
                    }
                }, 100);
            });
        }

        handlePickerClick(yearCol, 'year');
        handlePickerClick(monthCol, 'month');
        handlePickerClick(dayCol, 'day', true);

        openDateModal.onclick = function() {
            // Set pickerState to current date
            const [y, m, d] = selectedDateSpan.textContent.split('-');
            pickerState.year = parseInt(y);
            pickerState.month = parseInt(m);
            pickerState.day = parseInt(d);
            updatePickerCols();
            dateModalOverlay.classList.add('active');
        };
        cancelDate.onclick = function() {
            dateModalOverlay.classList.remove('active');
        };
        let lastStats = {
            depositNumber: 0,
            depositAmount: 0,
            numBettors: 0,
            totalBet: 0,
            numFirstDeposit: 0,
            firstDepositAmount: 0
        };

        function updateStatsBox(data) {
            document.getElementById('depositNumber').textContent = data.depositNumber;
            document.getElementById('depositAmount').textContent = data.depositAmount;
            document.getElementById('numBettors').textContent = data.numBettors;
            document.getElementById('totalBet').textContent = data.totalBet;
            document.getElementById('numFirstDeposit').textContent = data.numFirstDeposit;
            document.getElementById('firstDepositAmount').textContent = data.firstDepositAmount;
        }

        confirmDate.onclick = function() {
            const y = pickerState.year, m = pad(pickerState.month), d = pad(pickerState.day);
            const dateStr = `${y}-${m}-${d}`;
            selectedDateSpan.textContent = dateStr;
            dateModalOverlay.classList.remove('active');

            // Show loading spinner
            const spinner = document.getElementById('loadingSpinner');
            spinner.style.display = 'block';

            // Save current stats
            lastStats = {
                depositNumber: document.getElementById('depositNumber').textContent,
                depositAmount: document.getElementById('depositAmount').textContent,
                numBettors: document.getElementById('numBettors').textContent,
                totalBet: document.getElementById('totalBet').textContent,
                numFirstDeposit: document.getElementById('numFirstDeposit').textContent,
                firstDepositAmount: document.getElementById('firstDepositAmount').textContent
            };

            // Keep previous data for 0.3s, then update (increased by 0.2s)
            setTimeout(() => {
                const data = statsData[dateStr] || {
                    depositNumber: 0,
                    depositAmount: 0,
                    numBettors: 0,
                    totalBet: 0,
                    numFirstDeposit: 0,
                    firstDepositAmount: 0
                };
                updateStatsBox(data);
                spinner.style.display = 'none';
                document.getElementById('noData').style.display = '';
            }, 300);
        };

        // --- Tier Modal Logic (visual only, scrollable) ---
        const openTierModal = document.getElementById('openTierModal');
        const tierModalOverlay = document.getElementById('tierModalOverlay');
        const cancelTier = document.getElementById('cancelTier');
        const confirmTier = document.getElementById('confirmTier');
        const selectedTierSpan = document.getElementById('selectedTier');
        const tierCol = document.getElementById('tierCol');
        let selectedTier = "All";
        let tempSelectedTier = "All";
        const tierList = ["All", "Tier 1", "Tier 2", "Tier 3", "Tier 4", "Tier 5", "Tier 6"];

        function fillTierCol(selected) {
            tierCol.innerHTML = '';
            tierList.forEach(tier => {
                const div = document.createElement('div');
                div.className = 'tier-option' + (tier === selected ? ' selected' : '');
                div.textContent = tier;
                div.dataset.tier = tier;
                tierCol.appendChild(div);
            });
        }

        function scrollToSelectedTier() {
            const sel = tierCol.querySelector('.selected');
            if (sel) {
                tierCol.scrollTop = sel.offsetTop - tierCol.clientHeight/2 + sel.clientHeight/2;
            }
        }

        openTierModal.onclick = function(e) {
            tempSelectedTier = selectedTier;
            fillTierCol(selectedTier);
            setTimeout(scrollToSelectedTier, 10);
            tierModalOverlay.classList.add('active');
        };

        cancelTier.onclick = function() {
            tierModalOverlay.classList.remove('active');
        };

        confirmTier.onclick = function() {
            selectedTier = tempSelectedTier;
            selectedTierSpan.textContent = selectedTier;
            tierModalOverlay.classList.remove('active');
        };

        // Delegate click and scroll for tierCol
        tierCol.onclick = function(e) {
            if (e.target.classList.contains('tier-option')) {
                Array.from(tierCol.children).forEach(o => {
                    o.classList.remove('selected');
                    o.style.color = "#b0b0b0";
                    o.style.fontWeight = "normal";
                });
                e.target.classList.add('selected');
                e.target.style.color = "#222";
                e.target.style.fontWeight = "bold";
                tempSelectedTier = e.target.dataset.tier;
            }
        };
        tierCol.addEventListener('scroll', () => {
            clearTimeout(tierCol._scrollTimeout);
            tierCol._scrollTimeout = setTimeout(() => {
                let items = Array.from(tierCol.children);
                let closest = items.reduce((a, b) => {
                    return Math.abs(a.offsetTop - tierCol.scrollTop - tierCol.clientHeight/2 + a.clientHeight/2) <
                           Math.abs(b.offsetTop - tierCol.scrollTop - tierCol.clientHeight/2 + b.clientHeight/2) ? a : b;
                });
                Array.from(tierCol.children).forEach(o => {
                    o.classList.remove('selected');
                    o.style.color = "#b0b0b0";
                    o.style.fontWeight = "normal";
                });
                closest.classList.add('selected');
                closest.style.color = "#222";
                closest.style.fontWeight = "bold";
                tempSelectedTier = closest.dataset.tier;
            }, 100);
        });
    </script>
</body>
</html> 
